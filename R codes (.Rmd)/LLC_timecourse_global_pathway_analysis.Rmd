---
title: "LLC_timecourse_global_pathway_analysis"
author: "Alex Brown"
date: "2025-09-16"
output: html_document
---



# Load packages

```{r, include=FALSE}
library(Seurat)
library(SeuratWrappers)
library(tidyverse)
library(Biobase)
library(BiocGenerics)
library(ggplot2)
library(cowplot)
library(grid)
library(gridExtra)
library(RColorBrewer)
library(ggbeeswarm)
library(AnnotationDbi)
library(org.Mm.eg.db)
library(msigdbr)
library(clusterProfiler)
library(AnnotationDbi)
library(org.Mm.eg.db)
library(msigdbr)
```



# Load data

```{r, include=FALSE}
load("C:/Users/nwb_l/Documents/r_projects/LLC_timecourse/LLC_timecourse_processed.RData")
```



# DEGs for each cluster at each timepoint

```{r, include=FALSE}
Idents(LLC_MuSCs) <- "orig.ident"
Idents(LLC_Myonuclei) <- "orig.ident"
Idents(LLC_Endothelial_cells) <- "orig.ident"
Idents(LLC_vSMCs) <- "orig.ident"
Idents(LLC_Pericytes) <- "orig.ident"
Idents(LLC_FAPs) <- "orig.ident"
Idents(LLC_Platelets) <- "orig.ident"
Idents(LLC_Monocytes_macrophages) <- "orig.ident"
Idents(LLC_Neutrophils) <- "orig.ident"
Idents(LLC_B_cells) <- "orig.ident"
Idents(LLC_T_NK_cells) <- "orig.ident"
Idents(LLC_Neural_glial_cells) <- "orig.ident"
Idents(LLC_Schwann_cells) <- "orig.ident"


DEGs_MuSCs_2_v_Sham <- FindMarkers(LLC_MuSCs, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)

DEGs_MuSCs_2.5_v_Sham <- FindMarkers(LLC_MuSCs, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)

DEGs_MuSCs_3.5_v_Sham <- FindMarkers(LLC_MuSCs, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Myonuclei_2_v_Sham <- FindMarkers(LLC_Myonuclei, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)

DEGs_Myonuclei_2.5_v_Sham <- FindMarkers(LLC_Myonuclei, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)

DEGs_Myonuclei_3.5_v_Sham <- FindMarkers(LLC_Myonuclei, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Endothelial_cells_2_v_Sham <- FindMarkers(LLC_Endothelial_cells, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)

DEGs_Endothelial_cells_2.5_v_Sham <- FindMarkers(LLC_Endothelial_cells, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)

DEGs_Endothelial_cells_3.5_v_Sham <- FindMarkers(LLC_Endothelial_cells, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_vSMCs_2_v_Sham <- FindMarkers(LLC_vSMCs, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_vSMCs_2.5_v_Sham <- FindMarkers(LLC_vSMCs, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_vSMCs_3.5_v_Sham <- FindMarkers(LLC_vSMCs, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Pericytes_2_v_Sham <- FindMarkers(LLC_Pericytes, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Pericytes_2.5_v_Sham <- FindMarkers(LLC_Pericytes, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Pericytes_3.5_v_Sham <- FindMarkers(LLC_Pericytes, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_FAPs_2_v_Sham <- FindMarkers(LLC_FAPs, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_FAPs_2.5_v_Sham <- FindMarkers(LLC_FAPs, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_FAPs_3.5_v_Sham <- FindMarkers(LLC_FAPs, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Platelets_2_v_Sham <- FindMarkers(LLC_Platelets, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Platelets_2.5_v_Sham <- FindMarkers(LLC_Platelets, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Platelets_3.5_v_Sham <- FindMarkers(LLC_Platelets, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Monocytes_macrophages_2_v_Sham <- FindMarkers(LLC_Monocytes_macrophages, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Monocytes_macrophages_2.5_v_Sham <- FindMarkers(LLC_Monocytes_macrophages, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Monocytes_macrophages_3.5_v_Sham <- FindMarkers(LLC_Monocytes_macrophages, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Neutrophils_2_v_Sham <- FindMarkers(LLC_Neutrophils, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Neutrophils_2.5_v_Sham <- FindMarkers(LLC_Neutrophils, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Neutrophils_3.5_v_Sham <- FindMarkers(LLC_Neutrophils, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_B_cells_2_v_Sham <- FindMarkers(LLC_B_cells, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_B_cells_2.5_v_Sham <- FindMarkers(LLC_B_cells, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_B_cells_3.5_v_Sham <- FindMarkers(LLC_B_cells, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_T_NK_cells_2_v_Sham <- FindMarkers(LLC_T_NK_cells, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_T_NK_cells_2.5_v_Sham <- FindMarkers(LLC_T_NK_cells, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_T_NK_cells_3.5_v_Sham <- FindMarkers(LLC_T_NK_cells, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Neural_glial_cells_2_v_Sham <- FindMarkers(LLC_Neural_glial_cells, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Neural_glial_cells_2.5_v_Sham <- FindMarkers(LLC_Neural_glial_cells, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Neural_glial_cells_3.5_v_Sham <- FindMarkers(LLC_Neural_glial_cells, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)


DEGs_Schwann_cells_2_v_Sham <- FindMarkers(LLC_Schwann_cells, ident.1 = "2_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Schwann_cells_2.5_v_Sham <- FindMarkers(LLC_Schwann_cells, ident.1 = "2.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
DEGs_Schwann_cells_3.5_v_Sham <- FindMarkers(LLC_Schwann_cells, ident.1 = "3.5_weeks", ident.2 = "Sham", logfc.threshold = 0, min.pct = 0.10, verbose = FALSE)
```


## Subset DEGs for p_val_adj < 0.05 and acg_log2FC > 0.2

```{r, include=FALSE}
# --- MuSCs ---
DEGs_MuSCs_2_v_Sham <- na.omit(DEGs_MuSCs_2_v_Sham)
DEGs_MuSCs_2_v_Sham <- subset(DEGs_MuSCs_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_MuSCs_2.5_v_Sham <- na.omit(DEGs_MuSCs_2.5_v_Sham)
DEGs_MuSCs_2.5_v_Sham <- subset(DEGs_MuSCs_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_MuSCs_3.5_v_Sham <- na.omit(DEGs_MuSCs_3.5_v_Sham)
DEGs_MuSCs_3.5_v_Sham <- subset(DEGs_MuSCs_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Myonuclei ---
DEGs_Myonuclei_2_v_Sham <- na.omit(DEGs_Myonuclei_2_v_Sham)
DEGs_Myonuclei_2_v_Sham <- subset(DEGs_Myonuclei_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Myonuclei_2.5_v_Sham <- na.omit(DEGs_Myonuclei_2.5_v_Sham)
DEGs_Myonuclei_2.5_v_Sham <- subset(DEGs_Myonuclei_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Myonuclei_3.5_v_Sham <- na.omit(DEGs_Myonuclei_3.5_v_Sham)
DEGs_Myonuclei_3.5_v_Sham <- subset(DEGs_Myonuclei_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Endothelial cells ---
DEGs_Endothelial_cells_2_v_Sham <- na.omit(DEGs_Endothelial_cells_2_v_Sham)
DEGs_Endothelial_cells_2_v_Sham <- subset(DEGs_Endothelial_cells_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Endothelial_cells_2.5_v_Sham <- na.omit(DEGs_Endothelial_cells_2.5_v_Sham)
DEGs_Endothelial_cells_2.5_v_Sham <- subset(DEGs_Endothelial_cells_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Endothelial_cells_3.5_v_Sham <- na.omit(DEGs_Endothelial_cells_3.5_v_Sham)
DEGs_Endothelial_cells_3.5_v_Sham <- subset(DEGs_Endothelial_cells_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- vSMCs ---
DEGs_vSMCs_2_v_Sham <- na.omit(DEGs_vSMCs_2_v_Sham)
DEGs_vSMCs_2_v_Sham <- subset(DEGs_vSMCs_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_vSMCs_2.5_v_Sham <- na.omit(DEGs_vSMCs_2.5_v_Sham)
DEGs_vSMCs_2.5_v_Sham <- subset(DEGs_vSMCs_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_vSMCs_3.5_v_Sham <- na.omit(DEGs_vSMCs_3.5_v_Sham)
DEGs_vSMCs_3.5_v_Sham <- subset(DEGs_vSMCs_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Pericytes ---
DEGs_Pericytes_2_v_Sham <- na.omit(DEGs_Pericytes_2_v_Sham)
DEGs_Pericytes_2_v_Sham <- subset(DEGs_Pericytes_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Pericytes_2.5_v_Sham <- na.omit(DEGs_Pericytes_2.5_v_Sham)
DEGs_Pericytes_2.5_v_Sham <- subset(DEGs_Pericytes_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Pericytes_3.5_v_Sham <- na.omit(DEGs_Pericytes_3.5_v_Sham)
DEGs_Pericytes_3.5_v_Sham <- subset(DEGs_Pericytes_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- FAPs ---
DEGs_FAPs_2_v_Sham <- na.omit(DEGs_FAPs_2_v_Sham)
DEGs_FAPs_2_v_Sham <- subset(DEGs_FAPs_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_FAPs_2.5_v_Sham <- na.omit(DEGs_FAPs_2.5_v_Sham)
DEGs_FAPs_2.5_v_Sham <- subset(DEGs_FAPs_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_FAPs_3.5_v_Sham <- na.omit(DEGs_FAPs_3.5_v_Sham)
DEGs_FAPs_3.5_v_Sham <- subset(DEGs_FAPs_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Platelets ---
DEGs_Platelets_2_v_Sham <- na.omit(DEGs_Platelets_2_v_Sham)
DEGs_Platelets_2_v_Sham <- subset(DEGs_Platelets_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Platelets_2.5_v_Sham <- na.omit(DEGs_Platelets_2.5_v_Sham)
DEGs_Platelets_2.5_v_Sham <- subset(DEGs_Platelets_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Platelets_3.5_v_Sham <- na.omit(DEGs_Platelets_3.5_v_Sham)
DEGs_Platelets_3.5_v_Sham <- subset(DEGs_Platelets_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Monocytes/macrophages ---
DEGs_Monocytes_macrophages_2_v_Sham <- na.omit(DEGs_Monocytes_macrophages_2_v_Sham)
DEGs_Monocytes_macrophages_2_v_Sham <- subset(DEGs_Monocytes_macrophages_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Monocytes_macrophages_2.5_v_Sham <- na.omit(DEGs_Monocytes_macrophages_2.5_v_Sham)
DEGs_Monocytes_macrophages_2.5_v_Sham <- subset(DEGs_Monocytes_macrophages_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Monocytes_macrophages_3.5_v_Sham <- na.omit(DEGs_Monocytes_macrophages_3.5_v_Sham)
DEGs_Monocytes_macrophages_3.5_v_Sham <- subset(DEGs_Monocytes_macrophages_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Neutrophils ---
DEGs_Neutrophils_2_v_Sham <- na.omit(DEGs_Neutrophils_2_v_Sham)
DEGs_Neutrophils_2_v_Sham <- subset(DEGs_Neutrophils_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Neutrophils_2.5_v_Sham <- na.omit(DEGs_Neutrophils_2.5_v_Sham)
DEGs_Neutrophils_2.5_v_Sham <- subset(DEGs_Neutrophils_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Neutrophils_3.5_v_Sham <- na.omit(DEGs_Neutrophils_3.5_v_Sham)
DEGs_Neutrophils_3.5_v_Sham <- subset(DEGs_Neutrophils_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- B cells ---
DEGs_B_cells_2_v_Sham <- na.omit(DEGs_B_cells_2_v_Sham)
DEGs_B_cells_2_v_Sham <- subset(DEGs_B_cells_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_B_cells_2.5_v_Sham <- na.omit(DEGs_B_cells_2.5_v_Sham)
DEGs_B_cells_2.5_v_Sham <- subset(DEGs_B_cells_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_B_cells_3.5_v_Sham <- na.omit(DEGs_B_cells_3.5_v_Sham)
DEGs_B_cells_3.5_v_Sham <- subset(DEGs_B_cells_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- T/NK cells ---
DEGs_T_NK_cells_2_v_Sham <- na.omit(DEGs_T_NK_cells_2_v_Sham)
DEGs_T_NK_cells_2_v_Sham <- subset(DEGs_T_NK_cells_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_T_NK_cells_2.5_v_Sham <- na.omit(DEGs_T_NK_cells_2.5_v_Sham)
DEGs_T_NK_cells_2.5_v_Sham <- subset(DEGs_T_NK_cells_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_T_NK_cells_3.5_v_Sham <- na.omit(DEGs_T_NK_cells_3.5_v_Sham)
DEGs_T_NK_cells_3.5_v_Sham <- subset(DEGs_T_NK_cells_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Neural/glial cells ---
DEGs_Neural_glial_cells_2_v_Sham <- na.omit(DEGs_Neural_glial_cells_2_v_Sham)
DEGs_Neural_glial_cells_2_v_Sham <- subset(DEGs_Neural_glial_cells_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Neural_glial_cells_2.5_v_Sham <- na.omit(DEGs_Neural_glial_cells_2.5_v_Sham)
DEGs_Neural_glial_cells_2.5_v_Sham <- subset(DEGs_Neural_glial_cells_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Neural_glial_cells_3.5_v_Sham <- na.omit(DEGs_Neural_glial_cells_3.5_v_Sham)
DEGs_Neural_glial_cells_3.5_v_Sham <- subset(DEGs_Neural_glial_cells_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

# --- Schwann cells ---
DEGs_Schwann_cells_2_v_Sham <- na.omit(DEGs_Schwann_cells_2_v_Sham)
DEGs_Schwann_cells_2_v_Sham <- subset(DEGs_Schwann_cells_2_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Schwann_cells_2.5_v_Sham <- na.omit(DEGs_Schwann_cells_2.5_v_Sham)
DEGs_Schwann_cells_2.5_v_Sham <- subset(DEGs_Schwann_cells_2.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)

DEGs_Schwann_cells_3.5_v_Sham <- na.omit(DEGs_Schwann_cells_3.5_v_Sham)
DEGs_Schwann_cells_3.5_v_Sham <- subset(DEGs_Schwann_cells_3.5_v_Sham, p_val_adj < 0.05 & avg_log2FC > 0.2)
```



# KEGG pathway analysis

```{r, include=FALSE}
run_kegg <- function(deg_df) {
  if(nrow(deg_df) == 0) return(NULL)  # skip empty DEG tables
  ids <- bitr(
    rownames(deg_df),
    fromType = "SYMBOL",
    toType   = "ENTREZID",
    OrgDb    = org.Mm.eg.db
  )
  enrichKEGG(
    gene         = ids$ENTREZID,
    organism     = "mmu",
    keyType      = "kegg",
    pvalueCutoff = 0.05
  )
}

# --- MuSCs ---
DEGs_MuSCs_2_v_Sham_upkegg <- run_kegg(DEGs_MuSCs_2_v_Sham)
DEGs_MuSCs_2.5_v_Sham_upkegg <- run_kegg(DEGs_MuSCs_2.5_v_Sham)
DEGs_MuSCs_3.5_v_Sham_upkegg <- run_kegg(DEGs_MuSCs_3.5_v_Sham)

# --- Myonuclei ---
DEGs_Myonuclei_2_v_Sham_upkegg <- run_kegg(DEGs_Myonuclei_2_v_Sham)
DEGs_Myonuclei_2.5_v_Sham_upkegg <- run_kegg(DEGs_Myonuclei_2.5_v_Sham)
DEGs_Myonuclei_3.5_v_Sham_upkegg <- run_kegg(DEGs_Myonuclei_3.5_v_Sham)

# --- Endothelial cells ---
DEGs_Endothelial_cells_2_v_Sham_upkegg <- run_kegg(DEGs_Endothelial_cells_2_v_Sham)
DEGs_Endothelial_cells_2.5_v_Sham_upkegg <- run_kegg(DEGs_Endothelial_cells_2.5_v_Sham)
DEGs_Endothelial_cells_3.5_v_Sham_upkegg <- run_kegg(DEGs_Endothelial_cells_3.5_v_Sham)

# --- vSMCs ---
DEGs_vSMCs_2_v_Sham_upkegg <- run_kegg(DEGs_vSMCs_2_v_Sham)
DEGs_vSMCs_2.5_v_Sham_upkegg <- run_kegg(DEGs_vSMCs_2.5_v_Sham)
DEGs_vSMCs_3.5_v_Sham_upkegg <- run_kegg(DEGs_vSMCs_3.5_v_Sham)

# --- Pericytes ---
DEGs_Pericytes_2_v_Sham_upkegg <- run_kegg(DEGs_Pericytes_2_v_Sham)
DEGs_Pericytes_2.5_v_Sham_upkegg <- run_kegg(DEGs_Pericytes_2.5_v_Sham)
DEGs_Pericytes_3.5_v_Sham_upkegg <- run_kegg(DEGs_Pericytes_3.5_v_Sham)

# --- FAPs ---
DEGs_FAPs_2_v_Sham_upkegg <- run_kegg(DEGs_FAPs_2_v_Sham)
DEGs_FAPs_2.5_v_Sham_upkegg <- run_kegg(DEGs_FAPs_2.5_v_Sham)
DEGs_FAPs_3.5_v_Sham_upkegg <- run_kegg(DEGs_FAPs_3.5_v_Sham)

# --- Platelets ---
DEGs_Platelets_2_v_Sham_upkegg <- run_kegg(DEGs_Platelets_2_v_Sham)
DEGs_Platelets_2.5_v_Sham_upkegg <- run_kegg(DEGs_Platelets_2.5_v_Sham)
DEGs_Platelets_3.5_v_Sham_upkegg <- run_kegg(DEGs_Platelets_3.5_v_Sham)

# --- Monocytes/macrophages ---
DEGs_Monocytes_macrophages_2_v_Sham_upkegg <- run_kegg(DEGs_Monocytes_macrophages_2_v_Sham)
DEGs_Monocytes_macrophages_2.5_v_Sham_upkegg <- run_kegg(DEGs_Monocytes_macrophages_2.5_v_Sham)
DEGs_Monocytes_macrophages_3.5_v_Sham_upkegg <- run_kegg(DEGs_Monocytes_macrophages_3.5_v_Sham)

# --- Neutrophils ---
DEGs_Neutrophils_2_v_Sham_upkegg <- run_kegg(DEGs_Neutrophils_2_v_Sham)
DEGs_Neutrophils_2.5_v_Sham_upkegg <- run_kegg(DEGs_Neutrophils_2.5_v_Sham)
DEGs_Neutrophils_3.5_v_Sham_upkegg <- run_kegg(DEGs_Neutrophils_3.5_v_Sham)

# --- B cells ---
DEGs_B_cells_2_v_Sham_upkegg <- run_kegg(DEGs_B_cells_2_v_Sham)
DEGs_B_cells_2.5_v_Sham_upkegg <- run_kegg(DEGs_B_cells_2.5_v_Sham)
DEGs_B_cells_3.5_v_Sham_upkegg <- run_kegg(DEGs_B_cells_3.5_v_Sham)

# --- T/NK cells ---
DEGs_T_NK_cells_2_v_Sham_upkegg <- run_kegg(DEGs_T_NK_cells_2_v_Sham)
DEGs_T_NK_cells_2.5_v_Sham_upkegg <- run_kegg(DEGs_T_NK_cells_2.5_v_Sham)
DEGs_T_NK_cells_3.5_v_Sham_upkegg <- run_kegg(DEGs_T_NK_cells_3.5_v_Sham)

# --- Neural/glial cells ---
DEGs_Neural_glial_cells_2_v_Sham_upkegg <- run_kegg(DEGs_Neural_glial_cells_2_v_Sham)
DEGs_Neural_glial_cells_2.5_v_Sham_upkegg <- run_kegg(DEGs_Neural_glial_cells_2.5_v_Sham)
DEGs_Neural_glial_cells_3.5_v_Sham_upkegg <- run_kegg(DEGs_Neural_glial_cells_3.5_v_Sham)

# --- Schwann cells ---
DEGs_Schwann_cells_2_v_Sham_upkegg <- run_kegg(DEGs_Schwann_cells_2_v_Sham)
DEGs_Schwann_cells_2.5_v_Sham_upkegg <- run_kegg(DEGs_Schwann_cells_2.5_v_Sham)
DEGs_Schwann_cells_3.5_v_Sham_upkegg <- run_kegg(DEGs_Schwann_cells_3.5_v_Sham)
```


## .csv for KEGG pathways

```{r, include=FALSE}
# --- MuSCs ---
write.csv(DEGs_MuSCs_2_v_Sham_upkegg, file = "DEGs_MuSCs_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_MuSCs_2.5_v_Sham_upkegg, file = "DEGs_MuSCs_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_MuSCs_3.5_v_Sham_upkegg, file = "DEGs_MuSCs_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Myonuclei ---
write.csv(DEGs_Myonuclei_2_v_Sham_upkegg, file = "DEGs_Myonuclei_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Myonuclei_2.5_v_Sham_upkegg, file = "DEGs_Myonuclei_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Myonuclei_3.5_v_Sham_upkegg, file = "DEGs_Myonuclei_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Endothelial cells ---
write.csv(DEGs_Endothelial_cells_2_v_Sham_upkegg, file = "DEGs_Endothelial_cells_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Endothelial_cells_2.5_v_Sham_upkegg, file = "DEGs_Endothelial_cells_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Endothelial_cells_3.5_v_Sham_upkegg, file = "DEGs_Endothelial_cells_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- vSMCs ---
write.csv(DEGs_vSMCs_2_v_Sham_upkegg, file = "DEGs_vSMCs_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_vSMCs_2.5_v_Sham_upkegg, file = "DEGs_vSMCs_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_vSMCs_3.5_v_Sham_upkegg, file = "DEGs_vSMCs_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Pericytes ---
write.csv(DEGs_Pericytes_2_v_Sham_upkegg, file = "DEGs_Pericytes_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Pericytes_2.5_v_Sham_upkegg, file = "DEGs_Pericytes_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Pericytes_3.5_v_Sham_upkegg, file = "DEGs_Pericytes_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- FAPs ---
write.csv(DEGs_FAPs_2_v_Sham_upkegg, file = "DEGs_FAPs_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_FAPs_2.5_v_Sham_upkegg, file = "DEGs_FAPs_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_FAPs_3.5_v_Sham_upkegg, file = "DEGs_FAPs_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Platelets ---
write.csv(DEGs_Platelets_2_v_Sham_upkegg, file = "DEGs_Platelets_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Platelets_2.5_v_Sham_upkegg, file = "DEGs_Platelets_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Platelets_3.5_v_Sham_upkegg, file = "DEGs_Platelets_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Monocytes/macrophages ---
write.csv(DEGs_Monocytes_macrophages_2_v_Sham_upkegg, file = "DEGs_Monocytes_macrophages_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Monocytes_macrophages_2.5_v_Sham_upkegg, file = "DEGs_Monocytes_macrophages_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Monocytes_macrophages_3.5_v_Sham_upkegg, file = "DEGs_Monocytes_macrophages_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Neutrophils ---
write.csv(DEGs_Neutrophils_2_v_Sham_upkegg, file = "DEGs_Neutrophils_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Neutrophils_2.5_v_Sham_upkegg, file = "DEGs_Neutrophils_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Neutrophils_3.5_v_Sham_upkegg, file = "DEGs_Neutrophils_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- B cells ---
write.csv(DEGs_B_cells_2_v_Sham_upkegg, file = "DEGs_B_cells_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_B_cells_2.5_v_Sham_upkegg, file = "DEGs_B_cells_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_B_cells_3.5_v_Sham_upkegg, file = "DEGs_B_cells_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- T/NK cells ---
write.csv(DEGs_T_NK_cells_2_v_Sham_upkegg, file = "DEGs_T_NK_cells_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_T_NK_cells_2.5_v_Sham_upkegg, file = "DEGs_T_NK_cells_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_T_NK_cells_3.5_v_Sham_upkegg, file = "DEGs_T_NK_cells_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Neural/glial cells ---
write.csv(DEGs_Neural_glial_cells_2_v_Sham_upkegg, file = "DEGs_Neural_glial_cells_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Neural_glial_cells_2.5_v_Sham_upkegg, file = "DEGs_Neural_glial_cells_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Neural_glial_cells_3.5_v_Sham_upkegg, file = "DEGs_Neural_glial_cells_3.5_v_Sham_upkegg.csv", row.names = TRUE)

# --- Schwann cells ---
write.csv(DEGs_Schwann_cells_2_v_Sham_upkegg, file = "DEGs_Schwann_cells_2_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Schwann_cells_2.5_v_Sham_upkegg, file = "DEGs_Schwann_cells_2.5_v_Sham_upkegg.csv", row.names = TRUE)
write.csv(DEGs_Schwann_cells_3.5_v_Sham_upkegg, file = "DEGs_Schwann_cells_3.5_v_Sham_upkegg.csv", row.names = TRUE)
```



### Enriched signaling pathways

# MuSCs
### 3.5-weeks: TNF, IL-17, FoxO, JAK-STAT, MAPK, Toll-like receptor, C-type lectin receptor, Adipocytokine, Prolactin, p53, NOD-like receptor, AGE-RAGE, NF-kappa B



# Myonuclei
### 3.5-weeks: HIF-1, IL-17



# Endothelial cells
### 2-weeks: MAPK, JAK-STAT, NOD-like receptor, HIF-1, Estrogen

### 2.5-weeks: JAK-STAT, HIF-1, Adipocytokine, FoxO

### 3.5-weeks: TNF, MAPK, HIF-1



# vSMCs
### 3.5-weeks: Fc epsilon RI



# Pericytes
### 2.5-weeks: Sphingolipid, Relaxin, Estrogen, Apelin, Retrograde endocannabinoid, Oxytocin, AcGMP-PKG, Chemokine, Rap1, cAMP

### 3.5-weeks: IL-17



# FAPs
### 3.5-weeks: HIF-1, JAK-STAT, IL-17, AGE-RAGE, p53, P13K-Akt



# Platelets
### NONE



# Monocytes/macrophages
### 2-weeks: Estrogen

### 3.5-weeks: TNF, IL-17, AGE-RAGE, NF-kappa B, C-type lectin receptor, MAPK, Toll-like receptor, Estrogen, p53, B cell receptor, JAK-STAT, Chemokine, Adipocytokine, Prolactin, NOD-like receptor, T cell receptor



# Neutrophils
### 2.5-weeks: JAK-STAT, Adipocytokine

### 3.5-weeks: HIF-1, TNF, NOD-like receptor, JAK-STAT, IL-17, NF-kappa B, C-type lectin, Adipocytokine, FoxO, B cell receptor



# B cells
### NONE



# T cells/NK cells
### NONE



# Neural/glial cells
### NONE



# Schwann cells
### 3.5-weeks: TNF



# Signaling pathway	2-weeks	2.5-weeks	3.5-weeks	Total
IL-17	0	0	7	7
JAK-STAT	1	2	4	7
TNF	0	0	5	5
HIF-1	1	1	3	5
Adipocytokine	0	2	2	4
MAPK	1	0	3	4
NOD-like receptor	1	0	3	4
Estrogen	2	1	1	4
C-type lectin receptor	0	0	3	3
p53	0	0	3	3
AGE-RAGE	0	0	3	3
NF-kappa B	0	0	3	3
FoxO	0	1	2	3
Prolactin	0	0	2	2
B cell receptor	0	0	2	2
Chemokine	0	1	1	2
Toll-like receptor	0	0	2	2
Fc epsilon RI	0	0	1	1
P13K-Akt	0	0	1	1
T cell receptor	0	0	1	1
Sphingolipid	0	1	0	1
Relaxin	0	1	0	1
Apelin	0	1	0	1
Retrograde endocannabinoid	0	1	0	1
Oxytocin	0	1	0	1
AcGMP-PKG	0	1	0	1
Rap1	0	1	0	1
cAMP	0	1	0	1
















































